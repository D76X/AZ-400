# PT00-Q02: 


## Complete Case Study

### Overview:

Company 1 is a retail company specialized in gaming furniture and runs its systems
in Azure. To keep the sustainable groth of the business, the company wants to improve its **logging and telemetry** solutions.

You were hired as a **Site Reliability Engineer (SRE)** to improve the **logging and telemetry** solutions. 

---

### Environment:

The company has the following applications running **in production**:

1. Application 1: a microservices solution on  Azure Kubernetes Services (AKS).
   This is hosted in the **Central US** region.  

2. Application 2: an ASP.NET Core 5 application running on Azure App Service
   to support an e-commenrce frontend. 
   This is hosted in the **Central US** region.  

3. Application 3: a .NET 5 application running in Azure Functions.
   The Azure Funtion is hosted in the **East US** region. 

---

### Requirements:

1. App1 uses **Prometheus** and  **Log Analytics** to collect metrics and logs for individual services.
2. **Prometheus** collects metrics from the services using **pod annotations**.
3. All services in App1 should expose metrics to **Prometheous** using the 
   **/mymetrics** endpoint and the **StatsD exporter default port**.
4. App2, App3, and compatible microservices in App1 should be integrated with 
   the **Application Insights SDK server-side telemetry**.
5. **App2 requires allerts** bases on page load performance, excluding authentication errors.
6. Enable distributed tracing for a **Python microservice** in App1.
7. Implement 3  Loag Analytics Workspaces as shown in the Log Analytics section.
8. Use a cetralized workspace for all applications.
9. Different teams maintain App1 & App2.
   Each team should have access to logs related to their applicayion only.
     

---

### Issues:

After implementing a proof of concept (POC), you identify the following issues:

1. A service in App1 does not have its metrics scraped. 
   **Prometheous** and the **pod annotations** for the service are configured as shown below:

- **Prometheous ConfigMap**:

```
prometheous-data-collection-settings: |-
[prometheous_data_collection_settings.cluster]
interval = "1m"
monitor_kubernetes_pods = true
```

- **Pod Annotations**:

```
- prometheous.io/scrape:"true"
- prometheous.io/scheme:"http"
- prometheous.io/path:"/mymetrics"
- prometheous.io/port:"8080"
```

2. App2 and App3 telemetry voulumes are approximately 10 GB per day per application.
   This exceeds the soulution budget.

---

### Log Analytics workspaces:

- Workspace1:

This Log Analytics Workspace is configured as follows:

| Property          | Value |
| ----------------- | --------------------------------------------------- |
| Resource group    | az-400 |
| Status            | active |
| Location          | Central US |
| Subscription      | Company1 |
| Pricing Tier      | ay-as-you-go |
| Access Control Mode | Require Workspace Permission |
| tags | none |

- Workspace2:

This Log Analytics Workspace is configured as follows:

| Property          | Value |
| ----------------- | --------------------------------------------------- |
| Resource group    | az-400 |
| Status            | active |
| Location          | East US |
| Subscription      | Company1 |
| Pricing Tier      | ay-as-you-go |
| Access Control Mode | Use resource or Workspace Permission |
| tags | none |


- Workspace3:

---







